<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Finite Population Block Kriging with Detection • FPBKPack2</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Finite Population Block Kriging with Detection">
<meta property="og:description" content="This package performs Finite Population Block Kriging on spatial count data. The primary outputs are an estimate of the total count in the region, an estimated prediction variance, and a map of the predicted and observed values.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-11414212-0"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-11414212-0');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">FPBKPack2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/ShinyVignette.html">Using the GSPE Shiny App</a>
    </li>
    <li>
      <a href="articles/my-vignette.html">Using the GSPE R Package</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/highamm/FPBKPack2">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    

    
    
<!-- README.md is generated from README.Rmd. Please edit that file -->
<div id="fpbkpack2" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#fpbkpack2" class="anchor"></a>FPBKPack2</h1></div>
<p>The website for <code>FPBKPack2</code> can be found at its <a href="https://highamm.github.io/FPBKPack2/">Package Website</a>.</p>
<p>The goal of <code>FPBKPack2</code> is to predict a population total when</p>
<ol style="list-style-type: decimal">
<li>There are a finite number of sites in a region of interest.</li>
<li>Not all of the sites are sampled.</li>
<li>There might be imperfect detection of units on the sites that are sampled.</li>
<li>There is spatial autocorrelation among the counts.</li>
</ol>
<p>Note that the estimator is called the <em>GSPE</em> (Geo-Spatial Population Estimator) by many biologists in Alaska and Canada. Throughout the website and package documentation, <em>FPBK</em> (Finite Population Block Kriging) estimator and the <em>GSPE</em> are used interchangeably. Both refer to the same prediction process.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the FPBKPack2 from <a href="https://github.com/highamm/FPBKPack2">GitHub</a> with:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## install.packages("devtools")
devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/reexports.html">install_git</a></span>(<span class="st">"https://github.com/highamm/FPBKPack2.git"</span>)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(FPBKPack2)</code></pre></div>
</div>
<div id="basic-example" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-example" class="anchor"></a>Basic Example</h2>
<p>The following example shows how to predict the counts on unsampled sites in a simulated data set. See the <code>Using the GSPE R Package</code> vignette under “Articles” of the <a href="https://highamm.github.io/FPBKPack2/">Package Website</a> for a more detailed description of how to use the package.</p>
<p>The plot below shows that only some of the sites were sampled. In this simulated example, the counts represent moose. The remaining sites that were not sampled do not have observed moose counts. In the plot below, sites without observed counts are coloured grey.</p>
<p><img src="reference/figures/README-example-1.png" width="100%"></p>
<p>We can also examine the first six observations of the data set with the observed counts:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(basicdf))</code></pre></div>
<table class="table table">
<thead><tr class="header">
<th align="right">X</th>
<th align="right">Xcoords</th>
<th align="right">Ycoords</th>
<th align="right">Moose</th>
<th align="right">CountPred</th>
<th align="right">DetPred1</th>
<th align="right">DetPred2</th>
<th align="left">Stratum</th>
<th align="right">Area</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">127</td>
<td align="right">0.3157895</td>
<td align="right">0.3157895</td>
<td align="right">9</td>
<td align="right">4.302138</td>
<td align="right">0.0421800</td>
<td align="right">-0.7164407</td>
<td align="left">Low</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">76</td>
<td align="right">0.7894737</td>
<td align="right">0.1578947</td>
<td align="right">23</td>
<td align="right">1.901080</td>
<td align="right">0.9236562</td>
<td align="right">1.6464221</td>
<td align="left">Low</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">78</td>
<td align="right">0.8947368</td>
<td align="right">0.1578947</td>
<td align="right">NA</td>
<td align="right">2.507180</td>
<td align="right">0.2561130</td>
<td align="right">-0.0964677</td>
<td align="left">Low</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">20</td>
<td align="right">1.0000000</td>
<td align="right">0.0000000</td>
<td align="right">NA</td>
<td align="right">2.521382</td>
<td align="right">0.3524129</td>
<td align="right">-1.8202738</td>
<td align="left">Low</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">219</td>
<td align="right">0.9473684</td>
<td align="right">0.5263158</td>
<td align="right">0</td>
<td align="right">3.692670</td>
<td align="right">0.0645832</td>
<td align="right">0.8484421</td>
<td align="left">Low</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">48</td>
<td align="right">0.3684211</td>
<td align="right">0.1052632</td>
<td align="right">NA</td>
<td align="right">3.086353</td>
<td align="right">0.4623587</td>
<td align="right">-1.1950225</td>
<td align="left">High</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
<p>Note that any site that does not have an observed moose count has an <code>NA</code> value in the <code>Moose</code> column.</p>
<p>To predict the counts on the unobserved sites, we fit a spatial linear model (<code>slmfit</code>), use finite population block kriging to predict counts on the unobserved sites from the linear model (<code>predict</code>), obtain summary output (<code>FPBKoutput</code>), and obtain a data set with sitewise predictions and an HTML summary report (<code>get_reportdoc</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">slmobj &lt;-<span class="st"> </span><span class="kw"><a href="reference/slmfit.html">slmfit</a></span>(<span class="dt">formula =</span> Moose <span class="op">~</span><span class="st"> </span>Stratum,
  <span class="dt">data =</span> basicdf,
  <span class="dt">xcoordcol =</span> <span class="st">"Xcoords"</span>,
  <span class="dt">ycoordcol =</span> <span class="st">"Ycoords"</span>)
predobj &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(<span class="dt">object =</span> slmobj)
outputobj &lt;-<span class="st"> </span><span class="kw"><a href="reference/FPBKoutput.html">FPBKoutput</a></span>(<span class="dt">pred_info =</span> predobj)

pred_df &lt;-<span class="st"> </span>outputobj<span class="op">$</span>predvals
<span class="kw"><a href="reference/get_reportdoc.html">get_reportdoc</a></span>(outputobj)</code></pre></div>
<p>We can also incorporate imperfect detection by adding a couple of extra arguments (see Sections 2 and 3 of the Article <code>Using the GSPE R Package</code>). The Article also has information on other options to the functions, such as specifying a specific region to predict, fitting separate covariance models for each stratum, etc.</p>
<p>Finally, the Article <code>Using the GSPE Shiny App</code> gives directions on how to upload data and then use the package with a <code>Shiny</code> interface.</p>
<p>Links to videos on how to use the <code>Shiny</code> app interface are given below:</p>
<ol style="list-style-type: decimal">
<li><p><a href="https://www.youtube.com/watch?v=I6L_-MlNgcw">Loading the Shiny App</a></p></li>
<li><p><a href="https://www.youtube.com/watch?v=Rp8Oefyda18">Using the Shiny App with Perfect Detection</a></p></li>
<li><p><a href="https://www.youtube.com/watch?v=OtELtk-Yink">Incorporating Imperfect Detection into the Shiny App</a></p></li>
</ol>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/highamm/FPBKPack2">https://​github.com/​highamm/​FPBKPack2</a>
</li>
<li>Report a bug at <br><a href="https://github.com/highamm/FPBKPack2/issues">https://​github.com/​highamm/​FPBKPack2/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>CC0</li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing FPBKPack2</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Higham Matt <br><small class="roles"> Maintainer, author </small>  </li>
<li>Ver Hoef Jay <br><small class="roles"> Author </small>  </li>
<li>Madsen Lisa <br><small class="roles"> Author </small>  </li>
</ul>
</div>


      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Higham Matt, Ver Hoef Jay, Madsen Lisa.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9100.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
